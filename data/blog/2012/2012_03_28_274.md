Существует два способа взаимодействия со скайпом. Первый и основной - <a href="http://developer.skype.com/public/skypekit">SkypeKit</a>. Это набор из бинарного ядра, заботливо собранного мейнтейнером для всех ОС, и биндингов к нему на питоне, джаве и плюсах. Все это доступно по подписке, которая стоит 5 долларов разовым платежом и поставляется со скудной документацией, которая представляет собой скорее <a href="http://developer.skype.com/skypekit/reference/python/html/">описание API</a>&nbsp;(нам не привыкать к Epydoc, ага), да и то не всех методов и свойств. Зато в нагрузку вы получите с десяток разных предупреждений о секретности и конфиденциальности полученных файлов. А вот качество реализации очень хромает, ваш покорный слуга так и не смог найти тот event, который поднимается при получения запроса на авторизацию. В интернете, что характерно, информации тоже сущие крупицы и, в большинстве своем, по биндингу на C++, но, разобравшись со всем необходимым функционалом методом проб и ошибок, вы получите доступ к абсолютно всем функциям Skype. Ну и для запуска бинарника ядра из SkypeKit SDK в той же Linux версии никакие иксы не нужны, что тоже заметное преимущество перед вторым способом - <a href="http://developer.skype.com/public-api-reference">Skype API</a>. Этот вариант представляет из себя набор протоколов взаимодействия с скайповым гуем через Skype.framework для MacOS, X11 и DBUS для Linux, COM-интерфейс на Windows. Основные минусы: острая необходимость в запущенном клиенте, который жрет ресурсы и требует наличия иксов, ну и относительная глючность, сравнительно с первым вариантом.&nbsp;<div><br></div><div>Ходят бездарные&nbsp;<a href="http://news.ycombinator.com/item?id=2611299">слухи</a>, что в скором времени мы получим еще и третий способ - нативная библиотека без каких-либо лимитов. Подобные разговоры начались после деобфускации бинарника скайпа и продолжаются по мере наполнения репозитория&nbsp;<a href="https://github.com/skypeopensource/">https://github.com/skypeopensource/</a>.&nbsp;Хотя, между нами, девочками, наполняется он кодом такого низкого качества, что меня одолевают сомнения, будет ли доведен проект до рабочего образца.<div><br></div><div>Я решил использовать SkypeAPI. Прежде всего, я вообще не знал о существовании SkypeKit, вот такой вот стыдный прокол. Впрочем, оно и к лучшему, меньше времени ушло на написание того, что не работало. Аналогов необходимых мне функций, доступных в старой питоновской библиотек&nbsp;<a href="http://skype4py.sourceforge.net/doc/html/">Skype4Py</a>, в SDK просто просто не оказалось. Допускаю, что я просто плохо искал, но тем не менее. Бота мы с вами будем писать не простого, а умного, который сможет поддерживать элементарный разговор, ну или даже послать. Тут нам на помощь приходит&nbsp;<a href="http://en.wikipedia.org/wiki/AIML">AIML</a>&nbsp;- XML-производный язык разметки логики ботов в стиле "поболтать". Совсем удачно нашлась и библиотека&nbsp;<a href="http://pyaiml.sourceforge.net/">PyAIML</a>, которая сделала создание умного болтливого робота делом трех строк кода. Для начала, нам нужны мозги.&nbsp;</div><div><br></div><div>Мозги можно взять в мясном магазине, стушить их вместе с цветной капустой или спаржевой фасолью, подать с белым вином, забив на продолжение этого поста. Если такие кулинарные изыски вас не прельщают, то открывайте <a href="http://code.google.com/p/aiml-en-us-foundation-alice/">Google Code</a>, куда добрые люди выложили и до сих пор продолжают комитить большой жирный сет aiml-ок, которые помогут машине начать думать и чувствовать. Прежде чем продолжить, нужно перевести мозги из XML разметки в бинарный формат, иначе каждый раз ваш бот будет запускаться по 5-10 минут. Все это делается с помощью <a href="https://code.google.com/p/mindcollapse-com-blog-source/source/browse/small_projects/SkypeBot/Learn.py">такого простого кода</a> на Python. Будьте готовы к исправлениям файлов своими собственными руками, многие из них просто не проходят валидацию и парсер отваливается с печальными новостям. Обычно все проблемы либо в незакрытом теге, либо в неэкранированном спецсимволе, или точке гулящей. Процесс это утомительный и неспешный, но во всем есть свои плюсы: по мере редактирования вы познакомитесь с синтаксисом AIML.</div></div><div><br></div><div>На этом можно было бы и закончить, 3 строки кода и ваш бот научился говорить и отвечать на полученные сообщения. &nbsp;Но нам все мало. Давайте приделаем возможность взять трубку и поговорить голосом с заделом на кроссплатформенность, сведя зависимости и сложность кода к минимуму. Для этого мы будем использовать 2 бинарника, которые собираются под всеми системами, и 2 неофициальных APIшки от Google. Внимание, код и описание предоставлены исключительно для ознакомления. Я настоятельно не рекомендую нарушать лицензионное соглашение. Помни, каждый раз, когда ты отправляешь запрос по этим ссылкам, Эрик Шмидт убивает котенка.&nbsp;Нужно было написать, уже были прецеденты. Вернемся к нашим API. Первый - TTS, который используется в Google Translate и переводит текст в MP3. Как это работает, можете <a href="https://code.google.com/p/mindcollapse-com-blog-source/source/browse/small_projects/SkypeBot/__init__.py#186">посмотреть в коде</a>. Впрочем, рано радоваться - наш Skype не поймет, если ему в Output канал мы будем засовывать не теплый ламповый WAV (16Khz, 256kb/s, Mono), а ужатый MPEG. Я пытался декодировать с помощью медиакомбайна ffmpeg, но Скайп наотрез отказывался понимать полученный файл. Именно поэтому, мы и будем использовать <a href="http://www.mpg123.de/">mpg123</a>, который очень быстро справляется с поставленной задачей. Вот так у нас и получилась функция перевода текста в речь, которую вы можете использовать в любом проекте. Идем дальше - <a href="https://code.google.com/p/mindcollapse-com-blog-source/source/browse/small_projects/SkypeBot/__init__.py#147">записываем</a> 10 секунд речи нашего собеседника и тут бы не помешало перевести ее в текст. Нам опять поможет Google и API, выдранное из Хромиума, которое как раз этим и занимается. Тут возникает следующая проблема - &nbsp;отдавать нужно не WAV, a FLAC. К счастью, есть одноименный проект <a href="http://flac.sourceforge.net/">на сурсфорже,</a> который мало того, что кроссплатформенный, так еще и быстрый, как воображение школьника в женской раздевалке.</div><div><br></div><div><a href="https://code.google.com/p/mindcollapse-com-blog-source/source/browse/small_projects/SkypeBot/__init__.py">Итог</a> запускается вместе с скайповским GUI в каком-то Xvfb или даже в Xvnc, что предпочтительней, так как вам нужно будет подтвердить права доступа нашей программы к API кликом мыши. В качестве проверки можете <a href="skype:alice.mindcollapse?chat">написать</a> или <a href="skype:alice.mindcollapse?call">позвонить</a>&nbsp;на ID alice.mindcollapse. Она будет доступна не круглосуточно. Если остается молчаливой - значит ушла спать вместе со мной и ответит, главное, отошлите ей запрос на авторизацию. Ах да, в блог, следуя моде, вернулись социальные кнопки. Теперь все в ваших руках: стоит ли мне писать о своем первом сексуальном опыте со слепой усатой проститукой, или рассказывать о написании модуля ядра для Embedded Linux. Просто <a href="http://www.mindcollapse.com/blog/274.html">перейдите на веб версию</a> поста и щелкните лениво мышкой, поставив +1 или рассказав братюням. Ван лов, пацанва.&nbsp;</div>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>Yandex Maps для iPhone (YaMap Web)</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/214.html">

        
            <link rel="next" href="https://www.mindcollapse.com/blog/213.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/215.html">
        

        <meta property="og:title" content="Yandex Maps для iPhone (YaMap Web)">
        <meta property="og:description" content="Мне очень нравится браузер в iPhone. По сути, он дал начало новой эры мобильного интернета, поставив на свое место разнообразные огрызки для уродливых симбианов типа Оперы Мини и иже с ним. Построен он (как и браузер Android, Palm Pre и прочих современных ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/214.html">

        <meta name="description" content="Мне очень нравится браузер в iPhone. По сути, он дал начало новой эры мобильного интернета, поставив на свое место разнообразные огрызки ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Мне очень нравится браузер в iPhone. По сути, он дал начало новой эры мобильного интернета, поставив на свое место разнообразные огрызки для уродливых симбианов типа ...">
        <meta name="twitter:title" content="Yandex Maps для iPhone (YaMap Web)">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="publisher" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?85fbe913" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" async src="/static/compiled/blog.js?06c0e12a"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                    <li><a target="_blank" href="/moho/">Кино</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="http://www.twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/214.html">Yandex Maps для iPhone (YaMap Web)</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2010-01-13T00:00:00Z" class="text-muted updated">13 января 2010 г.</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            Мне очень нра­вит­ся бра­у­зер в iPhone. По су­ти, он дал на­ча­ло но­вой эры мо­биль­но­го ин­тер­не­та, по­ста­вив на свое ме­сто раз­но­об­раз­ные огрыз­ки для урод­ли­вых сим­би­а­нов ти­па Опе­ры Ми­ни и иже с ним. По­стро­ен он (как и бра­у­зер Android, Palm Pre и про­чих со­вре­мен­ных мо­биль­ных ОС) на осно­ве <a href="http://webkit.org/">webkit</a>, что да­ет воз­мож­ность рен­де­рить стра­ни­цы имен­но та­ки­ми, ка­кие они есть, а не так, как это вла­зит на экран­чик фин­ско­го смарт­фо­на (да, я знаю о су­ще­ство­ва­нии веб­ки­та для S60, но вы его ви­де­ли?). Это та­кая пре­лю­дия, даль­ше, как обыч­но, пре­ды­сто­рия =)<p></p><p>Од­на­жды по­че­му-то мне за­хо­те­лось по­иметь <a href="http://maps.yandex.ru/">Ян­декс.Кар­ты</a> на сво­ем устрой­стве. В апп­сто­ре бы­ли толь­ко <a href="http://nano.yandex.ru/project/yandex-traffic/">Ян­декс.Проб­ки</a>, ко­то­рый хоть вро­де как бы и кар­ты од­но­вре­мен­но с по­ис­ком и ЖПС, но до стан­дарт­но­го при­ло­же­ния гугло­мепс да­же и на цы­поч­ках с пал­кой в ру­ке не до­тя­ги­ва­ют. По­это­му я, как по­ла­га­ет­ся, по­че­сал ре­пу и при­сту­пил к на­пи­са­нию сво­их карт с блек­дже­ком, на­ви­га­ци­ей, из­бран­ны­ми мет­ка­ми и шлю­ха­ми. </p><p></p><p><strong>Опи­са­ние при­ло­же­ния</strong>: да­вай­те спер­ва не­по­сред­ствен­но про про­грамм­ку. Лич­но я счи­таю, что по­лу­чи­лось впол­не очень да­же. Для уста­нов­ки вам нуж­но все­го лишь от­крыть ссыл­ку <a href="/media/ymapw/">/media/ymapw/</a> в Safari на сво­ем ябло­фо­не и сле­до­вать ин­струк­ци­ям. По­сле это­го на ва­шем home screen долж­на по­явить­ся икон­ка YaMap Web, ее и за­пус­ка­ем. <a href="http://twitpic.com/xtoev">Ин­тер­фейс карт</a> и все дей­ствия ана­ло­гич­ны ори­ги­наль­ным гугло­кар­там. Ще­пок для уве­ли­че­ния\умень­ше­ния (по­ка это де­ла­ет­ся очень не­спеш­но, я в по­ис­ках ре­ше­ния), двой­ной tap для при­бли­же­ния к опре­де­лен­ной точ­ке. Име­ет­ся по­иск, вы­бор ти­па кар­ты, бы­строе пе­ре­ме­ще­ние к сво­е­му ме­сто­по­ло­же­нию по gps и отоб­ра­же­ние этих ко­ор­ди­нат на кар­те флаж­ком. Един­ствен­ное что - вы мо­же­те од­но­вре­мен­но тэп­нуть 2мя паль­ца­ми по экра­ну для скры­тия\отоб­ра­же­ния ме­ню. Очень удоб­но, если нуж­но рас­смот­реть что-то де­таль­но. В на­сто­я­щий мо­мент при­ло­же­ние уме­ет не мень­ше сво­е­го ори­ги­наль­но­го бра­та от ян­дек­са. Так в чем про­фит, %username%? Про­фит в том, что все это client-side, на­пи­са­но и ра­бо­та­ет на JavaScript, HTML + CSS3, до­бав­лять­ся мо­жет лю­бой функ­ци­о­нал, ка­кой ду­ша по­же­ла­ет. А фей­лы есть? Есть, без фей­лов в на­ше вре­мя ни­ку­да, по­ка что все ра­бо­та­ет с за­мет­ны­ми тор­мо­за­ми, что в прин­ци­пе не ме­ша­ет ис­поль­зо­ва­нию. На 3GS, ду­маю, долж­но во­об­ще иде­аль­но ид­ти, те­сти­ро­ва­лось и пи­са­лось на 3G. Еще од­ним фей­лом яв­ля­ет­ся landscape-ре­жим, мне по­ка лень его до­де­лы­вать, по­это­му отоб­ра­жа­ет­ся при по­во­ро­те экра­на все смеш­но, не­удоб­но и не­про­пор­ци­о­наль­но. Ис­прав­лю в бли­жай­шее вре­мя. В пла­нах - до­бав­ле­ние из­бран­но­го, про­клад­ки марш­ру­та меж­ду 2-мя точ­ка­ми и т.п.</p><p></p><p><strong>Осо­бен­но­сти на­ци­о­наль­ной ебал­ки</strong>: нуж­но от­дать долж­ное js про­грам­ми­стам ян­дек­са - код их карт и <a href="http://api.yandex.ru/maps/doc/">до­ку­мен­та­ция</a> API на­пи­са­ны очень хо­ро­шо и на ай­фо­не все за­пус­ка­ет­ся без про­блем с един­ствен­ным но: мо­биль­ный safari не зна­ет та­ких дей­ствий, как mousedown, mouseup, mousemove, что де­ла­ет drag-n-drop про­крут­ку кар­ты не­воз­мож­ной. В <a href="http://developer.apple.com/safari/library/documentation/AppleApplications/Reference/SafariWebContent/Introduction/Introduction.html">офи­ци­аль­ной до­ку­мен­та­ции</a> раз­ра­бот­чи­ка web при­ло­же­ний от Apple опи­сы­ва­ют сле­ду­ю­щие по­хо­жие event-ы: touchstart, touchchange, touchend, ко­то­рые по су­ти яв­ля­ют­ся ана­ло­га­ми мы­ши­ных со­бы­тий с од­ним ис­клю­че­ни­ем, это "мно­го­паль­це­вость" - в callback функ­цию воз­вра­ща­ет­ся event с па­ра­мет­ром-мас­си­вом touches, где каж­дый эле­мент яв­ля­ет­ся обыч­ным mousevent. В ито­ге все ре­ши­лось обыч­ным initMouseEvent - dispatchEvent для кон­тей­не­ра я.карт, то бишь, от­лав­ли­ва­ем touchstart, бе­рем из не­го пер­вый эле­мент и вы­зы­ва­ем c его зна­че­ни­я­ми mousedown . Для safari mobile есть еще 3 не­обыч­ных ти­па со­бы­тий - gesturestart, gestureend, gesturechange, ко­то­рые вы­зы­ва­ют­ся при вы­пол­не­ний стан­дарт­ных для ай­фо­на дви­же­ний: щи­па­ния для зу­ма ли­бо же вра­ще­ния 2-мя паль­ца­ми. На них бы­ло успеш­но на­ве­ше­но уве­ли­че­ние\умень­ше­ние мас­шта­ба кар­ты и скры­тие ме­ню. Еще од­ной про­бле­мой яв­ля­лось то, что dblclick не под­дер­жи­вал­ся, яв­ля­ясь си­стем­ным дей­стви­ем для ай­фо­на, при­шлось эму­ли­ро­вать, ра­с­чи­ты­вая ми­кро­тайм меж­ду дву­мя при­кос­но­ве­ни­я­ми к экра­ну. Вот соб­ствен­но и все по осо­бен­но­стям javascript-ов для ай­фо­на, все осталь­ное - ру­ти­на. По­след­нюю вер­сию ко­да мож­но по­смот­реть <a href="/media/ymapw/ymw.js">тут</a>. Ни­ка­кие <a href="http://api.yandex.ru/maps/agreement.xml">ли­цен­зии</a> сво­и­ми дей­стви­я­ми мы не на­ру­ша­ем, т.к. кар­ты отоб­ра­жа­ют­ся имен­но в веб-при­ло­же­нии и ни­ка­кие мо­ди­фи­ка­ции ко­да не про­во­ди­лись.</p>
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться радостью со своими воображаемыми друзьями в социальных сетях: <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/214.html">фейсбук</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/214.html&amp;text=Yandex%20Maps%20%D0%B4%D0%BB%D1%8F%20iPhone%20%28YaMap%20Web%29&amp;via=middlesizetit">твиттер</a>, <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/214.html">вконтакте</a></span>.</p>
    </footer>

    </main>   
</body>

</html>
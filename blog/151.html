<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>С чем едят MySQL prepared statements</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/151.html">
        
        
            <link rel="next" href="https://www.mindcollapse.com/blog/150.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/152.html">
        

        <meta property="og:title" content="С чем едят MySQL prepared statements">
        <meta property="og:description" content="Правду говорил Анонимус: век живи - век учись. Еще в версии 4.1 в mysql появилась такая вещь, как prepared statements, а узнал я это только вчера, перелистывая от нечего делать умирающий habrahabr - статьи стали занудными копипастами и любительскими ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/151.html">

        <meta name="description" content="Правду говорил Анонимус: век живи - век учись. Еще в версии 4.1 в mysql появилась такая вещь, как prepared statements, а узнал я это только вчера, ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Правду говорил Анонимус: век живи - век учись. Еще в версии 4.1 в mysql появилась такая вещь, как prepared statements, а узнал я это только вчера, перелистывая от нечего делать ...">
        <meta name="twitter:title" content="С чем едят MySQL prepared statements">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="author" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?85fbe913" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" src="/static/compiled/blog.js?06c0e12a"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                    <li><a target="_blank" href="/moho/">Кино</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="http://www.twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/151.html">С чем едят MySQL prepared statements</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2008-09-24T00:00:00Z" class="text-muted updated">24 сентября 2008 г.</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            Прав&shy;ду го&shy;во&shy;рил Ано&shy;ни&shy;мус: век жи&shy;ви - век учись. Еще в вер&shy;сии 4.1 в mysql&nbsp;по&shy;яви&shy;лась та&shy;кая вещь, как&nbsp;<a href="http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html">prepared statements</a>, а узнал я это толь&shy;ко вче&shy;ра, пе&shy;ре&shy;ли&shy;сты&shy;вая от не&shy;че&shy;го де&shy;лать уми&shy;ра&shy;ю&shy;щий <a href="http://habrahabr.ru/">habrahabr</a> - ста&shy;тьи ста&shy;ли за&shy;нуд&shy;ны&shy;ми ко&shy;пи&shy;па&shy;ста&shy;ми и лю&shy;би&shy;тель&shy;ски&shy;ми пе&shy;ре&shy;во&shy;да&shy;ми, но я не об этом. Что же это за сло&shy;во&shy;со&shy;чи&shy;та&shy;ние, пе&shy;ре&shy;ве&shy;ден&shy;ное <a href="http://translate.google.com/translate_t#en|ru|preparedstatements">Google Translate</a> как "под&shy;го&shy;тов&shy;лен&shy;ные за&shy;яв&shy;ле&shy;ния" =)? На&shy;вер&shy;ня&shy;ка, каж&shy;дый, кто хоть раз за&shy;ду&shy;мы&shy;вал&shy;ся о за&shy;щи&shy;те сво&shy;е&shy;го при&shy;ло&shy;же&shy;ния&nbsp;от инъ&shy;ек&shy;ций в ба&shy;зу дан&shy;ных, смот&shy;рел в сто&shy;ро&shy;ну биб&shy;лио&shy;тек с с под&shy;держ&shy;кой placeholder-ов, а ока&shy;за&shy;лось, что все это мож&shy;но де&shy;лать не&shy;по&shy;сред&shy;ствен&shy;но син&shy;так&shy;си&shy;сом mysql. Вот вам на за&shy;мет&shy;ку не&shy;боль&shy;шой лик&shy;без.Ис&shy;поль&shy;зо&shy;ва&shy;ние prepared statements да&shy;ет не&shy;пло&shy;хой при&shy;рост как к без&shy;опаст&shy;но&shy;сти, так и к про&shy;из&shy;во&shy;ди&shy;тель&shy;но&shy;сти. Что ка&shy;са&shy;ет&shy;ся пер&shy;во&shy;го, то при под&shy;ста&shy;нов&shy;ке пе&shy;ре&shy;мен&shy;ных в го&shy;то&shy;вый за&shy;прос сер&shy;вер ав&shy;то&shy;ма&shy;ти&shy;че&shy;ски экра&shy;ни&shy;ру&shy;ет все сим&shy;во&shy;лы, что в прин&shy;ци&shy;пе сво&shy;дит ве&shy;ро&shy;ят&shy;ность ле&shy;во&shy;го UNION-а, JOIN-а, ли&shy;бо дру&shy;гой па&shy;ко&shy;сти к ну&shy;лю. Что ка&shy;са&shy;ет&shy;ся ско&shy;ро&shy;сти, то тут то&shy;же есть свои ин&shy;те&shy;рес&shy;но&shy;сти. Во-пер&shy;вых, при мно&shy;го&shy;крат&shy;но по&shy;вто&shy;ря&shy;ю&shy;щих&shy;ся од&shy;но&shy;тип&shy;ных за&shy;про&shy;сах зна&shy;чи&shy;тель&shy;но ми&shy;ни&shy;ми&shy;зи&shy;ру&shy;ет&shy;ся траф&shy;фик меж&shy;ду про&shy;грам&shy;мой и сер&shy;ве&shy;ром БД, ну а во-вто&shy;рых mysql про&shy;ве&shy;ря&shy;ет син&shy;так&shy;сис за&shy;про&shy;са и пар&shy;сит его все&shy;го 1 раз, при ини&shy;ци&shy;а&shy;ли&shy;за&shy;ции placeholder-а. Вы мо&shy;же&shy;те ис&shy;поль&shy;зо&shy;вать дан&shy;ный функ&shy;ци&shy;о&shy;нал на INSERT, DELETE, UPDATE, SELECT и CREATE TABLE за&shy;про&shy;сах. Ра&shy;бо&shy;та&shy;ет, сле&shy;дуя ма&shy;ну&shy;а&shy;лу, это сле&shy;ду&shy;ю&shy;щим об&shy;ра&shy;зом. Сна&shy;ча&shy;ла под&shy;го&shy;тав&shy;ли&shy;ва&shy;ем за&shy;прос для даль&shy;ней&shy;ше&shy;го ис&shy;поль&shy;зо&shy;ва&shy;ния <span style="font-style: italic;">PREPARE getgoodprice FROM "SELECT `price` FROM `goods` WHERE `id`=?"</span>. По&shy;сле это&shy;го мо&shy;жем под&shy;став&shy;лять зна&shy;че&shy;ния в плей&shy;с&shy;хол&shy;дер, вы&shy;пол&shy;нив <span style="font-style: italic;">SET @goodid = 5</span>. Эту пе&shy;ре&shy;мен&shy;ную мы и под&shy;став&shy;ля&shy;ем в за&shy;прос <span style="font-style: italic;">EXECUTE getgoodprice USING @goodid</span>, по&shy;лу&shy;чая ана&shy;лог за&shy;про&shy;са <span style="font-style: italic;">SELECT `price` FROM `goods` WHERE `id`=5</span>. Вот так вот все про&shy;сто. Ра&shy;зу&shy;ме&shy;ет&shy;ся, на еди&shy;нич&shy;ных query на&shy;мно&shy;го луч&shy;ше экра&shy;ни&shy;ро&shy;вать пе&shy;ре&shy;да&shy;ва&shy;е&shy;мые зна&shy;че&shy;ния по&shy;сред&shy;ством функ&shy;ции язы&shy;ка про&shy;грам&shy;ми&shy;ро&shy;ва&shy;ния, но для мно&shy;же&shy;ства слож&shy;ных за&shy;про&shy;сов с не&shy;сколь&shy;ки&shy;ми па&shy;ра&shy;мет&shy;ра&shy;ми вы&shy;бор&shy;ки ли&shy;бо сор&shy;ти&shy;ров&shy;ки PREPARE под&shy;хо&shy;дит на ура. Ах да, из па&shy;мя&shy;ти со&shy;хра&shy;нен&shy;ный за&shy;прос уда&shy;ля&shy;ет&shy;ся по&shy;сред&shy;ством <span style="font-style: italic;">DEALLOCATE PREPARE getgoodpric</span>.
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться радостью со своими воображаемыми друзьями в социальных сетях: <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/151.html">фейсбук</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/151.html&amp;text=%D0%A1%20%D1%87%D0%B5%D0%BC%20%D0%B5%D0%B4%D1%8F%D1%82%20MySQL%20prepared%20statements&amp;via=middlesizetit">твиттер</a>, <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/151.html">вконтакте</a></span>.</p>
    </footer>

    </main>   
</body>

</html>
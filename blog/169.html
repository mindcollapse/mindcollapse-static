<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>Превращаем PHP класс в JS объект</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/169.html">

        
            <link rel="next" href="https://www.mindcollapse.com/blog/168.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/170.html">
        

        <meta property="og:title" content="Превращаем PHP класс в JS объект">
        <meta property="og:description" content="Если бы каждый раз, когда я слышу вопрос &#34;как из JS вызвать функцию PHP&#34; от очередного начинающего быдлокодера, делающего свою супер-пупер браузерную игру или чат, мне давали один доллар, то я бы давно скопил на хорошую FullHD плазменную панель. Объединить ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/169.html">

        <meta name="description" content="Если бы каждый раз, когда я слышу вопрос &#34;как из JS вызвать функцию PHP&#34; от очередного начинающего быдлокодера, делающего свою ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Если бы каждый раз, когда я слышу вопрос &#34;как из JS вызвать функцию PHP&#34; от очередного начинающего быдлокодера, делающего свою супер-пупер браузерную игру или чат, мне ...">
        <meta name="twitter:title" content="Превращаем PHP класс в JS объект">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="publisher" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?85fbe913" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" async src="/static/compiled/blog.js?06c0e12a"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                    <li><a target="_blank" href="/moho/">Кино</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="http://www.twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/169.html">Превращаем PHP класс в JS объект</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2008-12-02T00:00:00Z" class="text-muted updated">2 декабря 2008 г.</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            Если бы каж­дый раз, ко­гда я слы­шу во­прос "как из JS вы­звать функ­цию PHP" от оче­ред­но­го на­чи­на­ю­ще­го быд­ло­ко­де­ра, де­ла­ю­ще­го свою су­пер-пу­пер бра­у­зер­ную иг­ру или чат, мне да­ва­ли один дол­лар, то я бы дав­но ско­пил на хо­ро­шую FullHD плаз­мен­ную па­нель. Объ­еди­нить не­объ­еде­ня­е­мое - кри­сталь­ная меч­та маль­чи­ков, ко­то­рые с го­рем по­по­лам вы­учи­ли php, а на JS про­сто не хва­та­ет ум­ствен­ных ре­сур­сов, по­это­му эти лен­тяи по­сы­ла­лись нахуй с фор­му­ли­ров­кой "не еби се­бе и дру­гим мозг". Но вот ведь чу­де­са, сам столк­нул­ся в про­цес­се од­ной ша­баш­ки с по­доб­ной за­да­чей: для ва­ли­да­ции фор­мы су­ще­ство­вал класс ров­но на 25-ть ме­то­дов, ко­то­рые про­ве­ря­ли вся­кую ми­шу­ру, вро­де на­ли­чия де­нег на сче­ту кли­ен­та, пра­виль­ность вве­де­ных дан­ных и так да­лее. Про­бле­ма со­сто­я­ла в том, что к про­вер­ке нуж­но бы­ло до­ба­вить client-side на осно­ве JS. Пе­ре­пи­сы­вать все бы­ло очень тру­до­ем­ким про­цес­сом, да и не пред­став­ля­лось воз­мож­ным - про­цесс не огра­ни­чи­ва­лась ре­гу­ляр­ка­ми для мы­ла и ко­ли­че­ства ци­фе­рок в но­ме­ре кре­дит­ки. Имен­но по­это­му я на­пи­сал ма­лень­кий класс, ко­то­рый пре­вра­ща­ет PHP в JS объ­ект. Все очень про­сто: по­лу­ча­ем public ме­то­ды клас­са или огра­ни­чи­ва­ем­ся спис­ком из мас­си­ва, ко­то­рый пе­ре­да­ем вто­рым па­ра­мет­ром при ини­ци­а­ли­за­ции по­сле име­ни или ин­стан­са не­об­хо­ди­мо­го нам клас­са, со­зда­ем JS объ­ект с пре­фик­сом jsphp_ и со­от­вет­ству­ю­щи­ми ме­то­да­ми, каж­дый из ко­то­рых со­зда­ет ajax за­прос к backend, ко­то­рый в свою оче­редь об­ра­ба­ты­ва­ет за­прос (вы­зы­ва­ет со­от­вет­ству­ю­щий ме­тод PHP объ­ек­та) и воз­вра­ща­ет ре­зуль­тат. Ко­му ин­те­рес­но, то мож­но до­ба­вить еще и экс­порт гло­баль­ных пе­ре­мен­ных, ана­лог __construct, хра­нить со­здан­ный php объ­ект в сес­си­он­ной гло­баль­ной пе­ре­мен­ной, лич­но мне и так хва­та­ет.При­мер ра­бо­ты мож­но по­смот­реть по <a href="/media/etc/PHP/phpjs.php">ссыл­ке</a>, ис­ход­ный код до­сту­пен в <a href="/media/copypaste/phpjs.php">ко­пи­па­сте­ре</a>, javascript не­мно­го об­фус­ци­ру­ет­ся для при­ми­тив­ной за­щи­ты от де­би­лов. Для ajax за­про­са ис­поль­зу­ет­ся <a href="/blog/132.html">jquery</a>.
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться радостью со своими воображаемыми друзьями в социальных сетях: <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/169.html">фейсбук</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/169.html&amp;text=%D0%9F%D1%80%D0%B5%D0%B2%D1%80%D0%B0%D1%89%D0%B0%D0%B5%D0%BC%20PHP%20%D0%BA%D0%BB%D0%B0%D1%81%D1%81%20%D0%B2%20JS%20%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82&amp;via=middlesizetit">твиттер</a>, <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/169.html">вконтакте</a></span>.</p>
    </footer>

    </main>   
</body>

</html>
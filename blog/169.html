<!DOCTYPE html>
<html lang="ru">
<head>
    <title>Превращаем PHP класс в JS объект</title> 

    <meta charset="utf-8">

    <meta name="freezed" content="2013-10-22 18:55:06.855513">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    
        <link rel="canonical" href="http://www.mindcollapse.com/blog/169.html">

        <meta property="og:title" content="Превращаем PHP класс в JS объект">
        <meta property="og:description" content="Если бы каж­дый раз, ко­гда я слы­шу во­прос &#34;как из JS вы­звать функ­цию PHP&#34; от оче­ред­но­го на­чи­на­ю­ще­го быд­ло­ко­де­ра, де­ла­ю­ще­го свою су­пер-пу­пер бра­у­зер­ную иг­ру или чат, мне ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="http://www.mindcollapse.com/blog/169.html">

        <meta name="description" content="Если бы каж­дый раз, ко­гда я слы­шу во­прос &#34;как из JS вы­звать функ­цию PHP&#34; от оче­ред­но­го на­чи­на­ю­ще­го быд­ло­ко­де­ра, де­ла­ю­ще­го свою су­пер-пу­пер бра­у­зер­ную иг­ру или чат, мне ...">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Если бы каж­дый раз, ко­гда я слы­шу во­прос &#34;как из JS вы­звать функ­цию PHP&#34; от оче­ред­но­го на­чи­на­ю­ще­го быд­ло­ко­де­ра, де­ла­ю­ще­го свою су­пер-пу­пер бра­у­зер­ную иг­ру или чат, мне ...">
        <meta name="twitter:title" content="Превращаем PHP класс в JS объект">
    

    <link rel="author" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="http://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/rss+xml" title="RSS лента mindcollapse.com" href="http://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?78212916" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" src="/static/compiled/blog.js?b8dc5e57" defer></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <div class="container">

        <div class="header navbar navbar-default hidden-print" role="navigation">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </div>

            <div class="collapse navbar-collapse blogmenu">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                    <li><a target="_blank" href="/moho/">Кино</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="http://www.twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="http://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </div>
        </div>

        
	<div class="article" id="post_" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="content_header clearfix">
			<h1 itemprop="name" class="pull-left">Превращаем PHP класс в JS объект</h1>
			<div class="published pull-right"><span title="опубликован 1785 дней назад" itemprop="dateCreated" class="text-muted">2 декабря 2008 г.</span></div>
		</div>

		<hr class="first">

		<div itemprop="articleBody" class="content">
			Если бы каж&shy;дый раз, ко&shy;гда я слы&shy;шу во&shy;прос "как из JS вы&shy;звать функ&shy;цию PHP" от оче&shy;ред&shy;но&shy;го на&shy;чи&shy;на&shy;ю&shy;ще&shy;го быд&shy;ло&shy;ко&shy;де&shy;ра, де&shy;ла&shy;ю&shy;ще&shy;го свою су&shy;пер-пу&shy;пер бра&shy;у&shy;зер&shy;ную иг&shy;ру или чат, мне да&shy;ва&shy;ли один дол&shy;лар, то я бы дав&shy;но ско&shy;пил на хо&shy;ро&shy;шую FullHD плаз&shy;мен&shy;ную па&shy;нель. Объ&shy;еди&shy;нить не&shy;объ&shy;еде&shy;ня&shy;е&shy;мое - кри&shy;сталь&shy;ная меч&shy;та маль&shy;чи&shy;ков, ко&shy;то&shy;рые с го&shy;рем по&shy;по&shy;лам вы&shy;учи&shy;ли php, а на JS про&shy;сто не хва&shy;та&shy;ет ум&shy;ствен&shy;ных ре&shy;сур&shy;сов, по&shy;это&shy;му эти лен&shy;тяи по&shy;сы&shy;ла&shy;лись нахуй с фор&shy;му&shy;ли&shy;ров&shy;кой "не еби се&shy;бе и дру&shy;гим мозг". Но вот ведь чу&shy;де&shy;са, сам столк&shy;нул&shy;ся в про&shy;цес&shy;се од&shy;ной ша&shy;баш&shy;ки с по&shy;доб&shy;ной за&shy;да&shy;чей: для ва&shy;ли&shy;да&shy;ции фор&shy;мы су&shy;ще&shy;ство&shy;вал класс ров&shy;но на 25-ть ме&shy;то&shy;дов, ко&shy;то&shy;рые про&shy;ве&shy;ря&shy;ли вся&shy;кую ми&shy;шу&shy;ру, вро&shy;де на&shy;ли&shy;чия де&shy;нег на сче&shy;ту кли&shy;ен&shy;та, пра&shy;виль&shy;ность вве&shy;де&shy;ных дан&shy;ных и так да&shy;лее. Про&shy;бле&shy;ма со&shy;сто&shy;я&shy;ла в том, что к про&shy;вер&shy;ке нуж&shy;но бы&shy;ло до&shy;ба&shy;вить client-side на осно&shy;ве JS. Пе&shy;ре&shy;пи&shy;сы&shy;вать все бы&shy;ло очень тру&shy;до&shy;ем&shy;ким про&shy;цес&shy;сом, да и не пред&shy;став&shy;ля&shy;лось воз&shy;мож&shy;ным - про&shy;цесс не огра&shy;ни&shy;чи&shy;ва&shy;лась ре&shy;гу&shy;ляр&shy;ка&shy;ми для мы&shy;ла и ко&shy;ли&shy;че&shy;ства ци&shy;фе&shy;рок в но&shy;ме&shy;ре кре&shy;дит&shy;ки. Имен&shy;но по&shy;это&shy;му я на&shy;пи&shy;сал ма&shy;лень&shy;кий класс, ко&shy;то&shy;рый пре&shy;вра&shy;ща&shy;ет PHP в JS объ&shy;ект. Все очень про&shy;сто: по&shy;лу&shy;ча&shy;ем public ме&shy;то&shy;ды клас&shy;са или огра&shy;ни&shy;чи&shy;ва&shy;ем&shy;ся спис&shy;ком из мас&shy;си&shy;ва, ко&shy;то&shy;рый пе&shy;ре&shy;да&shy;ем вто&shy;рым па&shy;ра&shy;мет&shy;ром при ини&shy;ци&shy;а&shy;ли&shy;за&shy;ции по&shy;сле име&shy;ни или ин&shy;стан&shy;са не&shy;об&shy;хо&shy;ди&shy;мо&shy;го нам клас&shy;са, со&shy;зда&shy;ем JS объ&shy;ект с пре&shy;фик&shy;сом jsphp_ и со&shy;от&shy;вет&shy;ству&shy;ю&shy;щи&shy;ми ме&shy;то&shy;да&shy;ми, каж&shy;дый из ко&shy;то&shy;рых со&shy;зда&shy;ет ajax за&shy;прос к backend, ко&shy;то&shy;рый в свою оче&shy;редь об&shy;ра&shy;ба&shy;ты&shy;ва&shy;ет за&shy;прос (вы&shy;зы&shy;ва&shy;ет со&shy;от&shy;вет&shy;ству&shy;ю&shy;щий ме&shy;тод PHP объ&shy;ек&shy;та) и воз&shy;вра&shy;ща&shy;ет ре&shy;зуль&shy;тат. Ко&shy;му ин&shy;те&shy;рес&shy;но, то мож&shy;но до&shy;ба&shy;вить еще и экс&shy;порт гло&shy;баль&shy;ных пе&shy;ре&shy;мен&shy;ных, ана&shy;лог __construct, хра&shy;нить со&shy;здан&shy;ный php объ&shy;ект в сес&shy;си&shy;он&shy;ной гло&shy;баль&shy;ной пе&shy;ре&shy;мен&shy;ной, лич&shy;но мне и так хва&shy;та&shy;ет.При&shy;мер ра&shy;бо&shy;ты мож&shy;но по&shy;смот&shy;реть по <a href="/media/etc/PHP/phpjs.php">ссыл&shy;ке</a>, ис&shy;ход&shy;ный код до&shy;сту&shy;пен в <a href="/media/copypaste/phpjs.php">ко&shy;пи&shy;па&shy;сте&shy;ре</a>, javascript не&shy;мно&shy;го об&shy;фус&shy;ци&shy;ру&shy;ет&shy;ся для при&shy;ми&shy;тив&shy;ной за&shy;щи&shy;ты от де&shy;би&shy;лов. Для ajax за&shy;про&shy;са ис&shy;поль&shy;зу&shy;ет&shy;ся <a href="/blog/132.html">jquery</a>.
		</div>

		<hr>
		
		<div class="content_footer" class="hidden-print">
			<p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться радостью со своими воображаемыми друзьями в социальных сетях: <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=http%3A//www.mindcollapse.com/blog/169.html">фейсбук</a>, <a target="_blank" href="http://twitter.com/share?url=http%3A//www.mindcollapse.com/blog/169.html&amp;text=%D0%9F%D1%80%D0%B5%D0%B2%D1%80%D0%B0%D1%89%D0%B0%D0%B5%D0%BC%20PHP%20%D0%BA%D0%BB%D0%B0%D1%81%D1%81%20%D0%B2%20JS%20%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82&amp;via=middlesizetit">твиттер</a>, <a target="_blank" href="http://vkontakte.ru/share.php?url=http%3A//www.mindcollapse.com/blog/169.html">вконтакте</a></span>.</p>
		</div>
	</div>

    </div>

    <!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter22151810 = new Ya.Metrika({id:22151810, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/22151810" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->
                
</body>
</html>
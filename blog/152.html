<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>Darwin Video Streaming</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/152.html">

        
            <link rel="next" href="https://www.mindcollapse.com/blog/151.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/153.html">
        

        <meta property="og:title" content="Darwin Video Streaming">
        <meta property="og:description" content="Заказчик из далекой страны победившего капитализма заказал проект в основе которого лежала идея продажи аудио и видео контента через онлайн вещание для мобильных телефонов в формате 3gp для видео либо mp3 для аудио. Пользователь сам заказывает музыку ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/152.html">

        <meta name="description" content="Заказчик из далекой страны победившего капитализма заказал проект в основе которого лежала идея продажи аудио и видео контента ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Заказчик из далекой страны победившего капитализма заказал проект в основе которого лежала идея продажи аудио и видео контента через онлайн вещание для мобильных ...">
        <meta name="twitter:title" content="Darwin Video Streaming">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="publisher" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?85fbe913" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" src="/static/compiled/blog.js?06c0e12a"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                    <li><a target="_blank" href="/moho/">Кино</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="http://www.twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/152.html">Darwin Video Streaming</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2008-09-30T00:00:00Z" class="text-muted updated">30 сентября 2008 г.</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            За­каз­чик из да­ле­кой стра­ны по­бе­див­ше­го ка­пи­та­лиз­ма за­ка­зал про­ект в осно­ве ко­то­ро­го ле­жа­ла идея про­да­жи аудио и ви­део кон­тен­та че­рез он­лайн ве­ща­ние для мо­биль­ных те­ле­фо­нов в фор­ма­те 3gp для ви­део ли­бо mp3 для аудио. Поль­зо­ва­тель сам за­ка­зы­ва­ет му­зы­ку че­рез смс и по­лу­ча­ет со­об­ще­ние с ссыл­кой, по ко­то­рой, по­тея от не­тер­пе­ния, мо­жет по­смот­реть лю­би­мый клип с го­во­ря­щи­ми не­гра­ми, гру­да­сты­ми пры­га­ю­щи­ми блон­дин­ка­ми и про­чей вто­ро­сорт­ной пи­щей. Нам, че­ло­ве­кам, ко­то­рые зна­чок © ста­вят толь­ко пон­та ра­ди и счи­та­ют, что сло­во­со­че­та­ние "ав­тор­ские пра­ва" ро­дом из па­дон­ков­ско­го диа­лек­та, по­доб­но­го рас­то­чи­тель­ства не по­нять, но за пя­тью мо­ря­ми сот­ни по­доб­ных сер­ви­сов со­би­ра­ют не­пло­хие де­неж­ные сбе­ре­же­ния для бо­га­той и обес­пе­чен­ной ста­ро­сти со­зда­те­лей. Это та­кая се­бе на­вод­ка из се­рии "как за­ра­бо­тать се­бе на жизнь", в ко­то­рой я уже по­пи­сы­вал про <a href="/blog/133.html">GPS</a> и <a href="/blog/137.html">Wi-Fi</a>. Все, как во всех ска­зоч­ных ис­то­ри­ях, на­ча­лось с по­ис­ка opensource streaming сер­ве­ра. До это­го я од­на­жды уста­нав­ли­вал <a href="http://www.videolan.org/vlc/">VLC</a> для ре­транс­ля­ции па­ры де­биль­ных кли­пов че­рез http, что до­став­ля­ло не­ма­ло удо­воль­ствия для за­каз­чи­ка, но 3gp дан­ный сер­вер не под­дер­жи­вал, по­это­му ва­ри­ант мо­мен­таль­но от­пал. По­гуглив, я на­ткнул­ся на бес­плат­ный про­ект ав­тор­ства <a href="http://apple.com">Apple</a> с на­зва­ни­ем <a href="http://dss.macosforge.org/">Darwin</a>, ко­то­рое, меж­ду про­чим, но­сит еще и их OS для их су­пер­тон­ких, су­пер­а­лю­ми­ни­е­вых, су­пер­до­ро­гих и во­об­ще су­пер­су­пер­ных ком­пью­те­ров, ко­то­рые моя вро­жден­ная прак­тич­ность, гра­ни­ча­щая с жлоб­ством и ску­пер­дяй­ством, не поз­во­ля­ет ку­пить. Кста­ти, все ре­ли­зы (кро­ме по­след­не­го) сер­ве­ра <a href="http://dss.macosforge.org/post/41/">до­ступ­ны для ска­чи­ва­ния</a>, как для MacOS, так и для Solaris, Linux и да­же Windows. Уста­но­ви­лось все на centos эле­мен­тар­но: рас­па­ко­вы­ва­ем ар­хив, за­пус­ка­ем Install скрипт, вво­дим имя и па­роль ад­ми­ни­стра­то­ра и по­лу­ча­ем го­то­вый, ра­бо­та­ю­щий каст-сер­вер. Итак, все кон­фи­ги ле­жат по­сле уста­нов­ки по ад­ре­су /etc/streaming/&nbsp;в удоб­ном для ре­дак­ти­ро­ва­ния фор­ма­те XML. Нас ин­те­ре­су­ют файл streamingserver.xml, где мы из­ме­ня­ем па­ра­мет­ры movie_folder на ди­рек­то­рию, в ко­то­рую бу­дем ко­пи­ро­вать фай­лы для про­смот­ра (не за­будь­те chown qtss), bind_ip_addr для сер­ве­ров с не­сколь­ки­ми IP, в rtsp_port уда­ля­ем порт 8000 и 8001, если вам не нуж­на транс­ля­ция че­рез http. Не за­бы­ва­ем до­ба­вить пор­ты tcp 554 и 7070 (для rtsp) , а так же 1220 для web-ин­тер­фей­са ад­ми­ни­стра­то­ра в ACCEPT фа­ер­во­ла. Да­лее все про­сто, по­тен­ци­аль­ный лю­би­тель го­ло­са Брит­ни от­прав­ля­ет sms с ко­дом кли­па, ко­то­рое об­ра­ба­ты­ва­ет sms gateway-ем (от­дель­ная ин­те­рес­ная ис­то­рия) по­сле че­го же­ла­е­мый файл ко­пи­ру­ет­ся в ди­рек­то­рию /usr/local/movies/, а ссыл­ка ти­па rtsp://serverwithdarwin.com/sdflsdfa798/britney_spears_stronger.3gp вы­сы­ла­ет­ся поль­зо­ва­те­лю и мо­жет быть про­игра­на, как в де­фолт­ном но­ки­ев­ском пле­е­ре, так и в windows media player mobile и на­вер­ное во всех осталь­ных то­же. По ис­те­че­нию 2-х ча­сов файл уда­ля­ет­ся cron-ом. Пре­иму­ще­ства транс­ля­ции пе­ред предо­став­ле­ни­ем ссыл­ки на файл оче­вид­ны: на­мно­го мень­ше нуж­но пла­тить за ли­цен­зию, а жад­ные де­ти мо­гут за­ка­зы­вать ссыл­ки на один и тот же клип по не­сколь­ко раз, Брит­ни она ведь та­кая. К то­му же че­рез Darwin мож­но раз­да­вать и mp3 фай­лы со­вер­шен­но не па­рясь с из­ме­не­ни­ем на­стро­ек. Со­хра­нить дан­ные из по­то­ка на­мно­го слож­нее, чем обыч­ный файл, а на мо­биль­ном устрой­стве, фак­ти­че­ски, не­воз­мож­но. Од­ним сло­вом, Apple сде­ла­ли по на­сто­я­ще­му не­пло­хой про­ект, ко­то­рый и за день­ги не жал­ко бы­ло бы ку­пить, а за­дар­ма - грех не ис­поль­зо­вать. Я, в знак бла­го­дар­но­сти (хо­тя сра­ли они там на ме­ня), да­же ре­шил об­но­вить свой ста­рень­кий <a href="http://www.engadget.com/2006/09/12/2g-nano-announced/">Nano 2G</a>, с ко­то­рым бе­гаю уже ров­но 2 го­да и ко­то­рый ни ра­зу ме­ня не под­во­дил, на по­след­нее по­ко­ле­ние это­го же <a href="http://www.apple.com/ipodnano/">Nano</a>. Про­сто&nbsp;4 GB уже как-то ма­ло­ва­то, раз­бол­тал­ся порт на­уш­ни­ков, да и но­вый ин­тер­фейс на­мно­го сим­па­тич­нее. Вот прав­да в сто­ро­ну <a href="http://www.apple.com/ipodtouch/">Touch</a>-ей я да­же не смот­рю, от­сут­ствия click-wheel, ко­то­рым в кар­ма­не мож­но и гром­кость по­уба­вить, и уны­лый трек пе­ре­клю­чить, и нуд­ное ме­сто в ауди­окни­ге пе­ре­мо­тать, сво­дит все пре­иму­ще­ства пле­е­ра на нет, но это уже со­всем дру­гая ис­то­рия, о ко­то­рой, я, если об­нов­люсь, обя­за­тель­но на­пи­шу. Та­кие де­ла.
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться радостью со своими воображаемыми друзьями в социальных сетях: <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/152.html">фейсбук</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/152.html&amp;text=Darwin%20Video%20Streaming&amp;via=middlesizetit">твиттер</a>, <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/152.html">вконтакте</a></span>.</p>
    </footer>

    </main>   
</body>

</html>
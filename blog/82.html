<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>Душим спамеров на корню</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/82.html">

        
            <link rel="next" href="https://www.mindcollapse.com/blog/81.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/83.html">
        

        <meta property="og:title" content="Душим спамеров на корню">
        <meta property="og:description" content="Наверное, самыми мерзкими изобретениями человечества после фалоимитаторов, безалкогольного пива и мусульманских любовных сериалов является спам. (банально прозвучало, imho) Так случилось, что сервер, за который я ответственен, посетила ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/82.html">

        <meta name="description" content="Наверное, самыми мерзкими изобретениями человечества после фалоимитаторов, безалкогольного пива и мусульманских любовных ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Наверное, самыми мерзкими изобретениями человечества после фалоимитаторов, безалкогольного пива и мусульманских любовных сериалов является спам. (банально ...">
        <meta name="twitter:title" content="Душим спамеров на корню">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="publisher" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?85fbe913" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" async src="/static/compiled/blog.js?06c0e12a"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                    <li><a target="_blank" href="/moho/">Кино</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="http://www.twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/82.html">Душим спамеров на корню</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2007-11-16T00:00:00Z" class="text-muted updated">16 ноября 2007 г.</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            На­вер­ное, са­мы­ми мерз­ки­ми изоб­ре­те­ни­я­ми че­ло­ве­че­ства по­сле фа­ло­и­ми­та­то­ров, без­ал­ко­голь­но­го пи­ва и му­суль­ман­ских лю­бов­ных се­ри­а­лов яв­ля­ет­ся спам. (ба­наль­но про­зву­ча­ло, imho) Так слу­чи­лось, что сер­вер, за ко­то­рый я от­вет­стве­нен, по­се­ти­ла пе­чаль­ная участь - ip был за­не­сен в RBL и по­ло­ви­на всех пи­сем бло­ки­ро­ва­лись при ре­лее. А учи­ты­вая то, что на сер­ве­ре ра­бо­та­ло с 10 сай­тов, это впол­не мож­но бы­ло на­звать ка­та­стро­фой. Рас­сыл­ка про­ис­хо­ди­ла с по­мо­щью php mail (), то­бишь то­пор­ным, но дей­ствен­ным спо­со­бом. А учи­ты­вая то, что suexec был от­клю­чен, - все пись­ма ухо­ди­ли от де­фолт­но­го юзе­ра apache - nobody@blah-blah-blah. Про­бле­ма так же со­сто­я­ла в том, что сер­вер был че­ре­з­вы­чай­но по­се­ща­ем, а зна­чит про­че­сы­ва­ние ак­сес ло­гов апа­ча на пред­мет мно­же­ства POST или GET за­про­сов к од­но­му скрип­ту - не под­хо­дил.Соб­ствен­но, по­сле дол­гих му­че­ний и <a href="http://google.com">гугло­ко­вы­ря­ний</a> был най­ден спо­соб - <a href="http://www.lancs.ac.uk/~steveb/patches/php-mail-header-patch/">php mail header patch</a>.Но, мать­пе­ре­мать, на сер­ве­ре уста­нов­лен <a href="http://cpanel.net">СPanel</a>, и по­это­му, ва­ри­ант с patch -p1 на сыр­цы <em>/home/cpapachebuild/</em>, а опо­сля сбор­ка по­сред­ством <em>/scripts/easyapache</em> не ка­ти­ла, мерз­кий спа­ни­ель каж­дый раз ска­чи­вал со сво­е­го сер­ве­ра тар­бол php и имен­но его со­би­рал, а зна­чит и патч те­рял­ся.Шел вто­рой час <a href="http://google.com">гугло­ко­вы­ря­ний</a> и бы­ло най­де­но ре­ше­ние от <a href="http://choon.net/php-mail-header.php">Choon</a>, ко­то­рый лю­без­но предо­ста­вил патч вы­ше­упо­мя­ну­то­го ре­ше­ния для cpanel. Ко­ро­че, об­ра­до­ва­ло это не­имо­вер­но, му­че­ни­ям при­шел ко­нец, спа­мер­ский скрипт был от­лов­лен, а кли­ент по­лу­чил по ушам, за то что раз­да­вал свои па­ро­ли от FTP ак­каун­та на ле­во и на пра­во. Мо­раль сей бас­ни та­ко­ва - до­бав­ля­ем <em>disable_functions=mail</em> в <em>php.ini</em> : пусть ту­по­ры­лые про­грам­ми­сты вы­учат за­вет­ные 4 бук­вы <abbr title="Simple Mail Transfer Protocol">SMTP</abbr> и юза­ют ку­чу ве­ло­си­пе­дов, на­пи­сан­ных для ра­бо­ты с этим про­то­ко­лом. 
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться радостью со своими воображаемыми друзьями в социальных сетях: <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/82.html">фейсбук</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/82.html&amp;text=%D0%94%D1%83%D1%88%D0%B8%D0%BC%20%D1%81%D0%BF%D0%B0%D0%BC%D0%B5%D1%80%D0%BE%D0%B2%20%D0%BD%D0%B0%20%D0%BA%D0%BE%D1%80%D0%BD%D1%8E&amp;via=middlesizetit">твиттер</a>, <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/82.html">вконтакте</a></span>.</p>
    </footer>

    </main>   
</body>

</html>
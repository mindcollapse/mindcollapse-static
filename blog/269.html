<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>Делаем свою систему наблюдения и видеорегистрации</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/269.html">

        
            <link rel="next" href="https://www.mindcollapse.com/blog/268.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/270.html">
        

        <meta property="og:title" content="Делаем свою систему наблюдения и видеорегистрации">
        <meta property="og:description" content="Кроме всех известных и неизвестных науке способов заработка в интернете (вентиляторы москва кондиционеры купить ильхамзюлькорнеев download free), у меня есть и оффлайновое место работы. Невообразимо! Причем расположено оно в, мягко выражаясь, ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/269.html">

        <meta name="description" content="Кроме всех известных и неизвестных науке способов заработка в интернете (вентиляторы москва кондиционеры купить ильхамзюлькорнеев ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Кроме всех известных и неизвестных науке способов заработка в интернете (вентиляторы москва кондиционеры купить ильхамзюлькорнеев download free), у меня есть и ...">
        <meta name="twitter:title" content="Делаем свою систему наблюдения и видеорегистрации">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="publisher" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?626b399d" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" async src="/static/compiled/blog.js?c6c1320e"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="https://twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/269.html">Делаем свою систему наблюдения и видеорегистрации</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2011-12-08T00:00:00Z" class="text-muted updated">12 December, 2011</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            Кро­ме всех из­вест­ных и неиз­вест­ных нау­ке спосо­бов за­ра­ботка в ин­тер­не­те (вен­ти­ля­то­ры моск­ва кон­ди­ци­о­не­ры ку­пить иль­хам­зюль­кор­неев download free), у ме­ня есть и оф­флайно­вое ме­сто ра­бо­ты. Не­во­об­ра­зи­мо! При­чем рас­по­ло­же­но оно в, мяг­ко вы­ра­жа­ясь, не­благо­при­ят­ном спаль­ном рай­о­не, на­се­лен­ным про­дук­та­ми ген­ной му­та­ции, ро­див­ши­ми­ся и вы­росши­ми под воз­дей­стви­ем пив­ных и си­га­рет­ных про­дук­тов. И да­же учи­ты­вая то, что в по­ме­ще­нии прак­ти­че­ски по­сто­ян­но де­жу­рит охран­ник с та­ту­и­ров­кой Пя­так на паль­цах ле­вой ру­ки, хо­те­лось до­пол­ни­тель­но пере­стра­хо­вать­ся. Хо­тя бы от то­го же Пя­та­ка. В ито­ге бы­ло ре­ше­но свои­ми си­ла­ми сде­лать ка­кую-то про­стую си­сте­му ви­деона­блю­де­ния с реги­стра­ци­ей по­сто­ронних, ко­то­рые ша­рое­бят­ся у две­рей в не­по­ло­жен­ное на то вре­мя. Ко­неч­но, иде­аль­ным ва­ри­ан­том мог­ла быть стать ка­кая-то про­вод­ная DVR си­сте­ма, но по­ме­ще­ние срав­ни­тель­но большое и тянуть про­вод не пред­став­ля­лось воз­мож­ным по ку­че разных при­чин. Имен­но поэто­му я и на­чал погля­ды­вать в сто­ро­ну бес­про­вод­ных IP ка­мер, опыт по­куп­ки ко­то­рых я уже имел. По су­ти, а IP ка­ме­ра - ми­кро­компью­тер на ARM про­цес­со­ре с embedded linux, wi-fi адап­те­ром и web-мор­дой. Ра­зу­ме­ет­ся, ис­кать что-ли­бо в пре­де­лах Укра­и­ны не пред­став­ляет­ся воз­мож­ным, тут да­же пласт­массо­вый пры­щеб­ляд­ский длинк-хуе­линк с од­ним толь­ко ethernet пор­том сто­ит ка­ких-то дур­ных неаде­кват­ных де­нег. А вот на ебее или дил­экс­три­ме предло­же­ний хоть жо­пой жуй. Я оста­но­вил свой капризный и тре­бо­ва­тель­ный вы­бор на <a href="http://www.ebay.com/itm/270814484435?ssPageName=STRK:MEWNX:IT&amp;_trksid=p3984.m1497.l2649#ht_3990wt_977">вот та­ком ва­ри­ан­те</a>. Сде­лан он до­ста­точ­но хо­ро­шо, ка­че­ство ви­део­по­то­ка то­же ра­ду­ет глаз, но да­вайте обо всем по по­ряд­ку.<div><br/></div><div>Пре­жде всего, за­брав свои ка­ме­ры с по­чты, про­ду­майте ме­сто их креп­ле­ния. Я со­ве­тую при­кру­тить их где-то под на­ве­сом, по­то­му что ме­сто со­еди­не­ния про­во­да с самой ка­ме­рой вы­зы­ва­ет уж очень силь­ные подо­зре­ния в обе­ща­ни­ях 100% гид­роизо­ля­ции. Ре­ко­мен­дую за­лить ту­да немного си­ли­ко­на, ко­то­рым обыч­но гер­ме­ти­зи­ру­ют швы в ван­ной (во­дой за­ли­вать не бу­дет, а гиб­кость сохра­нит­ся), ли­бо, за неиме­ни­ем по­след­не­го, за­мо­тать это осно­ва­ние про­во­да изо­лен­той. Од­ним из ми­ну­сов IP ка­мер яв­ляет­ся необ­хо­ди­мость их пи­та­ния, обыч­но это что-то око­ло 9-12 вольт на 1-1,5 ам­пе­ра. Ну в лю­бом слу­чае вам бы при­шлось та­щить про­вод до ви­део реги­стра­то­ра, так что ищи­те пер­фо­ра­тор с хо­ро­шим свер­лом и, смах­нув ску­пую муж­скую сле­зу по кра­си­во­му оформ­ле­нию вну­трен­них стен, на­чи­найте бу­рить. К сло­ву, со­труд­ни­ки ва­ше­го по­кор­но­го слу­ги узна­ли много но­вых вы­ра­же­ний и их со­че­та­ний, ведь не­по­сред­ствен­но мне вы­па­ла огром­ная честь пер­фо­ри­ро­вать сте­ну из 50 сан­ти­мет­ров ка­че­ствен­но­го, теп­ло­го, лам­по­во­го ар­миро­ван­но­го бе­то­на с шиль­ди­ком "сде­ла­но в СССР с лю­бо­вью" нахуй. По­доб­ные воспо­ми­на­ние еще дол­го бу­дут за­став­лять ме­ня кри­чать во сне. Ско­рее всего, вам по­на­до­бит­ся рас­пре­де­ли­тель­ная ко­роб­ка (я не знаю, как это на­зы­ва­ет­ся эта пласт­массо­вая хрень, де­таль­ней уви­ди­те на фото­гра­фи­ях в кон­це по­ста). На кон­це подоб­ной ка­ме­ры есть <a href="http://www.tomtop.com/media/catalog/product/cache/1/image/ced77cb19565515451b3578a3bc0ea5e/f/i/file_682_1.jpg">та­кая вот киш­ка</a> с эзер­нет пор­том и бу­рить ды­ру с диа­мет­ром 10 см. вам ко­неч­но же не за­хо­чет­ся. Еще од­ним конструк­тив­ным недо­стат­ком яв­ляет­ся на­личие очень сла­бой но­ги креп­ле­ния. В частно­сти в ме­сте ее со­еди­не­ния с дис­ком, ко­то­рый при­кру­чи­ва­ет­ся к сте­не. Ки­тай­цы сэко­но­ми­ли и ба­наль­но сде­ла­ли две гайки, ко­то­рые с двух сто­рон при­жи­ма­ют этот диск. Ко­неч­но же эти гайки кру­тят­ся в од­ну и ту же сто­ро­ну, и, без ка­ких-ли­бо слож­но­стей, ка­ме­ра откру­чи­ва­ет­ся от сте­ны и уно­сит­ся в неиз­вест­ном направ­ле­нии с це­лью пере­про­да­жи или над­руга­тель­ства над ва­шей част­ной соб­ствен­но­стью. В этом мо­мен­те со­ве­тую де­фор­миро­вать резь­бу по­сле за­кру­чи­ва­ния гайки и запа­ять ее. По­сле это­го са­дит­ся как опыт­ная шлю­ха на мо­ря­ка даль­не­го пла­ва­нья, и без стре­мян­ки с шу­ру­по­вер­том ва­шу си­сте­му охра­ны спиз­дить ста­но­вит­ся до­ста­точ­но пробле­ма­тич­но. Важ­ным мо­мен­том яв­ляет­ся огра­ни­че­ние сво­бод­но­го до­сту­па к зад­ни­це ка­ме­ры. Ведь если кто и за­бе­рет­ся к вам "на ого­нек", то ему ни­че­го не бу­дет сто­ить лов­ким дви­же­ни­ем ру­ки пере­ру­бить ка­бель пи­та­ния, остав­шись при этом не­за­ме­чен­ным. Во­об­ще, за­щи­та это до­ста­точ­но хлип­кая. До­ста­точ­но ку­пить или со­брать направ­лен­ную шу­мел­ку в ча­стот­ном диапа­зо­не на 2,4Ггц, за­бить wifi ка­нал и спо­кой­но обой­ти дан­ную си­сте­му на­блю­де­ния. Но тут во­прос уже со­вер­шен­но дру­го­го по­ряд­ка: лич­но я уста­нав­ли­вал ка­ме­ры больше для пси­хо­ло­ги­че­ско­го эф­фек­та. Са­ми по­ни­ма­е­те, если за­хо­тят за­лезть и что-то спиз­дить, то су­ме­ют про­брать­ся да­же в Форт Нокс, а вся­ких ма­ло­ле­ток и па­то­ло­ги­че­ских при­дур­ков се­рьезная же­лезная ка­ме­ра, ми­га­ю­щая све­то­дио­дом, хо­ро­шо отпу­ги­ва­ет. Ме­жду про­чим, ки­тай­цы ле­пят на свои ка­ме­ры ик-дио­ды, но­чью все вид­но ве­ли­ко­леп­но, как днем пря­мо, но в ЧБ. За это им отдель­ный пла­мен­ный ре­спект. И еще, если у вас есть дру­гие спосо­бы за­щи­ты, то мо­же­те про­сто по­ис­кать на ебее по запро­су "fake camera". Вы­гля­дят не­ко­то­рые эк­зем­пля­ры да­же по­кру­че на­сто­я­щих, ми­га­ют све­то­дио­дом и уме­ют пи­щать при при­бли­же­нии к ним. </div><div><br/></div><div>Но нас под­дел­ки не ин­тере­су­ют, мы лю­бим все на­сто­я­щее, поэто­му про­дол­жим. По­сле под­клю­че­ния ва­ших ка­мер к эзер­нет пор­ту для на­строй­ки, вы мо­же­те впасть в со­сто­я­ние когни­тив­но­го дис­со­нан­са. На ка­ме­рах в за­водских на­строй­ках уста­нов­лен ста­ти­че­ский IP 192.168.1.100 и, если для сво­ей до­маш­ней се­ти вы вы­бра­ли что-то в диапа­зо­не 10.255.255.255, то ку­киш вам, а не веб мор­да. Веб ин­тер­фейс вы­гля­дит стан­дарт­но прак­ти­че­ски на всех ка­ме­рах. Хо­ро­ших фи­шек в нем много, но, как и все ки­тайское, ра­бо­та­ет оно очень эммммм по-осо­бен­но­му. В иде­а­ле, если от­лич­ная функ­ция Alarm, ко­то­рая опре­де­ля­ет ше­ве­ле­ние в зо­не ви­ди­мо­сти ка­ме­ры и уме­ет от­прав­лять кар­тин­ки не­го­дяя вам в по­что­вый ящик или же за­гру­жать их на FTP, а что самое важ­ное - раз­ре­ша­ет де­лать это по рас­пи­са­нию. В иде­а­ле. В жиз­ни все ра­бо­та­ет хуй как пой­ми. Ше­ду­лер там про­сто для кра­со­ты, на FTP в пас­сив­ном ре­жи­ме ни­че­го не за­гру­жа­ет­ся, а на по­чту пись­ма па­да­ют по­сто­ян­но од­ни и те же.  И да, если со­би­ра­е­тесь под­клю­чать дан­ную ка­ме­ру к wifi, то не за­будь­те <a href="https://picasaweb.google.com/110904145311662435301/ZSxCOJ#5683782744782269074">в на­строй­ках ва­ше­го ро­утера</a> Encription для WPA2-PSK вы­ста­вить в зна­че­ние TKIP. Это по­мо­жет ки­тайско­му гов­ну не те­рять под­клю­че­ние к се­ти каж­дые на­дцать ми­нут. Не сто­ит за­бы­вать и про то что wifi - ра­дио­сиг­нал, ко­то­рый име­ет не­при­ят­ное свой­ство те­рять­ся в ку­че же­ле­зо­бе­тон­ных конструк­ций. Для этой це­ли со­ве­тую до­ку­пить для ва­ше­го ру­тера до­пол­ни­тель­ную <a href="https://picasaweb.google.com/110904145311662435301/ZSxCOJ#5683782606287695746">уси­ли­ва­ю­щую ан­тен­ну</a>, пры­щеб­ляд­ский длинк про­да­ет подоб­ное. По­сле под­клю­че­ния и на­строй­ки всех жиз­нен­но важ­ных па­ра­мет­ров мы мо­жем при­сту­пать к на­строй­ке и раз­ра­ботке ПО.</div><div><br/></div><div>Так как веб мор­да ка­ме­ры сво­ей функ­ци­о­наль­но­стью нас то­таль­но разо­ча­ро­ва­ла, то пи­сать свою обе­зьян­ку, сле­дя­щую за ка­ме­ра­ми и от­лав­ли­ва­ю­щую празд­но ша­та­ю­щих­ся, мы бу­дет на python. Для ме­ня са­мым слож­ным в этой всей за­тее ка­за­лось рас­по­зна­ва­ния дви­же­ния на изоб­ра­же­нии, что, впро­чем, ре­ши­лось тре­мя стро­ка­ми ко­да благо­да­ря ве­ли­ко­леп­ной биб­лио­те­ке PIL. Все эти ва­ши GD и ImageMagic-и и в под­мет­ки не го­дят­ся. Сна­ча­ла я сде­лал это на ана­ли­зе кад­ров из mjpeg по­то­ка, но подоб­ная трата ре­сур­сов ока­за­лось из­ли­ше­ством. В двух сло­вах, сей­час мы про­сто срав­ни­ва­ем два изоб­ра­же­ния с ка­ме­ры с се­кундным ин­тер­ва­лом и по­лу­ча­ем раз­ни­ца уров­ней по R, G и B ка­на­лам. При нор­маль­ных усло­ви­ях от­сут­ствие дви­же­ния да­ет зна­че­ние око­ло трой­ки, при по­па­да­нии че­го-ли­бо круп­но­го в кадр зна­че­ние воз­рас­та­ет где-то до 15-50 в за­ви­си­мо­сти от раз­ме­ров объек­та. Все пере­па­ды осве­ще­ния, та­ра­ка­ны и ми­ни­а­тюр­ные цир­ковые кар­ли­ки лег­ко от­ру­ба­ют­ся по­вы­ше­ни­ем уров­ня чув­стви­тель­но­сти. Код де­мо­на <a href="https://code.google.com/p/ipcam-security/source/browse/trunk/capture.py">мож­но по­смот­реть</a>. Ло­ги­ка со­сто­ит в том, что в "не­по­ло­жен­ное" вре­мя при об­на­ру­же­нии дви­же­ния мы сохра­ня­ем изоб­ра­же­ние и каж­дые 5 ми­нут от­сы­ла­ем 10 по­след­них кар­ти­нок со злы­ми кри­ми­наль­ны­ми ро­жа­ми на элек­трон­ную по­чту "Большо­го брата", ну в смыс­ле вам. Код не ком­мен­ти­ро­ван, но ду­маю, что слож­но­стей воз­ник­нуть не долж­но. И да, со­ве­тую запрок­си­ро­вать вы­да­чу jpeg че­рез тот же proxy-pass в nginx с вклю­чен­ной бу­фе­ри­за­ци­ей. Сам по­ток ка­ме­ры лю­бит уми­рать, если его на­гру­зить дву­мя-тре­мя запро­са­ми од­новре­мен­но. Из­держ­ки це­ны, так ска­зать. С ра­до­стью от­ве­чу на все ва­ши во­про­сы, от­прав­лен­ные по ад­ре­сам в шап­ке бло­га. Спа­си­бо­по­жа­луй­ста.</div><div><br/></div><div>Фо­то­гра­фии саб­жа мож­но <a href="https://picasaweb.google.com/110904145311662435301/ZSxCOJ">по­смот­реть в пи­ка­се</a>.</div>
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться ссылкой в <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/269.html">фейсбуке</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/269.html&amp;text=%D0%94%D0%B5%D0%BB%D0%B0%D0%B5%D0%BC%20%D1%81%D0%B2%D0%BE%D1%8E%20%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%83%20%D0%BD%D0%B0%D0%B1%D0%BB%D1%8E%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%B8%20%D0%B2%D0%B8%D0%B4%D0%B5%D0%BE%D1%80%D0%B5%D0%B3%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%86%D0%B8%D0%B8&amp;via=middlesizetit">твиттере</a> или <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/269.html">в контакте</a></span>.</p>
    </footer>

    </main>
</body>

</html>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8">

    <title>Работаем с stream.twitter.com</title> 

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="jm8IGIWg4dsm0cTmih0sIVnUaWibc_hpOiQOlqb--9Y"> 
    <meta name="yandex-verification" content="4b85f46617ab1114"> 
    <meta name="y_key" content="04bed234d6a405cc"> 
    <meta name="msvalidate.01" content="62188F55275960794DDFA698C3EA9F05">

    <link rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.ru">
    <link rel="sitemap" href="https://www.mindcollapse.com/blog/sitemap.xml">

    
        <link rel="canonical" href="https://www.mindcollapse.com/blog/212.html">

        
            <link rel="next" href="https://www.mindcollapse.com/blog/211.html">
        

        
            <link rel="prev" href="https://www.mindcollapse.com/blog/213.html">
        

        <meta property="og:title" content="Работаем с stream.twitter.com">
        <meta property="og:description" content="Многим известно, что твиттер стал знаменитым не только по причине своей простоты и какой-то супер идеи, но и благодаря уникальному, интуитивно понятному для разработчика с IQ выше шимпанзе-олигофрена, но в то же время мощному API на котором появилось уже ...">
        <meta property="og:type" content="article">
        <meta property="og:site_name" content="mindcollapse.com">
        <meta property="og:url" content="https://www.mindcollapse.com/blog/212.html">

        <meta name="description" content="Многим известно, что твиттер стал знаменитым не только по причине своей простоты и какой-то супер идеи, но и благодаря уникальному, ...">

        <meta name="twitter:creator" content="@middlesizetit">
        <meta name="twitter:description" content="Многим известно, что твиттер стал знаменитым не только по причине своей простоты и какой-то супер идеи, но и благодаря уникальному, интуитивно понятному для ...">
        <meta name="twitter:title" content="Работаем с stream.twitter.com">

        
            <meta name="twitter:card" content="summary">
        
    

    <link rel="publisher" href="https://plus.google.com/110904145311662435301">
    <link rel="icon" href="https://www.mindcollapse.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="alternate" type="application/atom+xml" title="RSS лента mindcollapse.com" href="https://www.mindcollapse.com/blog.xml"> 

    
        <link href="/static/compiled/blog.css?47e4fb13" rel="stylesheet" media="all">
    

    
        <script type="text/javascript" async src="/static/compiled/blog.js?c6c1320e"></script>
    

    <!--[if lt IE 9]>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.js"></script>
    <![endif]-->
</head>

<body class="mindcollapse">
    <main class="container">
        <header class="header navbar navbar-default hidden-print">
            <nav class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".blogmenu">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a href="/" class="navbar-brand">Владимир Смирнов</a>
            </nav>

            <nav class="collapse navbar-collapse blogmenu" role="navigation">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Блог</a></li>
                    <li ><a href="/blog/archive/">Архив</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li><a target="_blank" href="https://twitter.com/middlesizetit">Twitter</a></li>
                    <li><a target="_blank" href="https://github.com/mindcollapse">GitHub</a></li>
                    <li><a href="https://www.mindcollapse.com/blog.xml">RSS</a></li>
                </ul>
            </nav>
        </header>

        
    <article class="article hentry" itemscope itemtype="http://schema.org/Article" role="main">
        <div class="content_header clearfix">
            <div itemprop="name" class="entry-title pull-left">
                <h1><a itemprop="url" href="https://www.mindcollapse.com/blog/212.html">Работаем с stream.twitter.com</a></h1>
            </div>

            <div class="published pull-right">
                <time itemprop="datePublished" datetime="2010-01-07T00:00:00Z" class="text-muted updated">7 января 2010 г.</time>
            </div>

            <div class="vcard author hidden">
                <a itemprop="author" class="url fn" href="http://www.mindcollapse.com/">Vladimir Smirnov</a>
            </div>
        </div>

        <hr class="first">

        <div itemprop="description" class="entry-content content">
            Мно­гим из­вест­но, что <a href="http://twitter.com/middlesizetit">твит­тер</a> стал зна­ме­ни­тым не толь­ко по при­чи­не сво­ей про­сто­ты и ка­кой-то су­пер идеи, но и бла­го­да­ря уни­каль­но­му, ин­ту­и­тив­но по­нят­но­му для раз­ра­бот­чи­ка с IQ вы­ше шим­пан­зе-оли­го­фре­на, но в то же вре­мя мощ­но­му <a href="http://apiwiki.twitter.com/Twitter-API-Documentation">API</a> на ко­то­ром по­яви­лось уже OVER 9000 раз­ных кли­ен­тов, сер­ви­сов, сай­тов, ко­то­рые соб­ствен­но этот API и ис­поль­зу­ют. Так вот, мне ста­ло ин­те­рес­но по­лу­чать ста­ти­сти­ку этих са­мых кли­ен­тов: кто кру­че и на греб­не вол­ны, дру­ги­ми сло­ва­ми. Дан­ные <a href="http://apiwiki.twitter.com/Twitter-REST-API-Method:-statuses-public_timeline">мож­но бы­ло</a> во­ро­вать ва­го­нет­ка­ми без ка­кой-ли­бо ав­то­ри­за­ции в xml, json, rss или atom обыч­ным GET за­про­сом. За 10 ми­нут на ле­вой ко­лен­ке был со­бран ма­лень­кий пер­ло­вый де­мон с ку­чей не­нуж­но­го му­со­ра и кри­вой ло­ги­кой (<a href="/media/copypaste/stream_twitterv1.perl">ис­ход­ный код</a>), ко­то­рый рас­пар­си­вал xml, до­ста­вал ссыл­ку кли­ен­та, его на­зва­ние и всо­вы­вал все это в БД. Един­ствен­ной про­бле­мой ока­за­лось то, что дан­ные это­го за­про­са твит­те­ром ке­ши­ру­ют­ся на 1 ми­ну­ту - ста­ти­сти­ка со­би­ра­лась очень мед­лен­но и ран­дом­но, и я уже по­чти по­ло­жил пе­нис, как уви­дел вни­зу до­ков линк на <a href="http://apiwiki.twitter.com/Streaming-API-Documentation">Streaming API</a>. Как ока­за­лось, су­ще­ству­ет не­кая аль­фа-вер­сия ин­тер­фей­са, поз­во­ля­ю­щая со­би­рать дан­ные http-по­то­ком с до­воль­но жир­ным рей­том. На на­пи­са­ния сле­ду­ю­ще­го ро­га­то­го с ви­ла­ми де­мо­на ушло еще мень­ше вре­ме­ни, за­то эта вер­сия во­об­ще бы­ла ли­ше­на не­нуж­ной хуй­ни и кон­фе­ти (<a href="/media/copypaste/stream_twitter.perl">ис­ход­ный код</a>). While (1) в прин­ци­пе и не ну­жен, LWP и так за­цик­ли­ва­ет­ся, ка­чая дан­ные из по­то­ка, но я за­ме­тил, что стрим­мер твит­те­ра ино­гда об­ры­ва­ет со­еди­не­ние 2-3 ра­за в сут­ки, так что ме­ра предо­сто­рож­но­сти не по­ме­ща­ет.<p></p><p>За па­ру-трой­ку ча­сов на­ва­ял и ху­до­соч­ный фронт­энд с не­кра­си­вым ми­ни­ма­лист­ским ди­зай­ном. Про­жи­ва­ет он по ад­ре­су <a href="/twitterapp/">/twitterapp</a>, об­нов­ля­ет­ся в ри­ал­тай­ме (за сут­ки со­жрал мил­ли­он твит­тов и не по­да­вил­ся), го­во­рит по ан­глий­ски. Бы­ло на­столь­ко лень что-то услож­нять, что для ге­не­ра­ции гра­фи­ка ис­поль­зу­ет­ся <a href="http://code.google.com/apis/chart/">Google Charts API</a>, ко­то­рый ока­зал­ся очень да­же ок для та­ких мел­ких дел. Если ну­жен код php-фронт­эн­да - сту­чи­те, но там все стан­дарт­но и ни­че­го ин­те­рес­но­го. Сер­вис про­сто just for fun, но за­то узнал па­роч­ку ин­те­рес­ных при­ло­же­ний из то­па. И да, мой лю­би­мый <a href="http://www.atebits.com/">Twettie</a> по­пал фде­сят­ку, это при­ят­но.</p>
        </div>
    </article>

    <hr>

    <footer class="footer hidden-print">
        <p>Что делать, если вы все прочитали и вам понравилось? Можете посмотреть мои остальные статьи в <a href="/blog/archive/">архиве</a> или поделиться ссылкой в <span class="social"><a target="_blank" href="http://www.facebook.com/sharer.php?u=https%3A//www.mindcollapse.com/blog/212.html">фейсбуке</a>, <a target="_blank" href="http://twitter.com/share?url=https%3A//www.mindcollapse.com/blog/212.html&amp;text=%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D0%BC%20%D1%81%20stream.twitter.com&amp;via=middlesizetit">твиттере</a> или <a target="_blank" href="http://vkontakte.ru/share.php?url=https%3A//www.mindcollapse.com/blog/212.html">в контакте</a></span>.</p>
    </footer>

    </main>
</body>

</html>